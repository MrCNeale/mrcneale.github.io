<!doctype html><html lang=en-us><head><title>Building an Azure lab environment via ARM templates - Part3 Saving Money with Auto Shutdown // Chris Neales Blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.105.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="John Doe"><meta name=description content><link rel=stylesheet href=https://www.chrisneale.org/css/main.min.0fb49e70a30412f97ddfc418e18fefef1d9fcdebe45f634dbbba768b00fe1eec.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Building an Azure lab environment via ARM templates - Part3 Saving Money with Auto Shutdown"><meta name=twitter:description content="Aim This post will show you how to take your existing template and add a special resource to it which is a &ldquo;Schedules&rdquo; resource which shuts down your VM at a specified time to save you money.
Pre-reqs You&rsquo;ll need:
Read/do Part 1 (https://www.chrisneale.org/Azure-Lab-via-Templates-Part1/) Read/do Part 2 (https://www.chrisneale.org/Azure-Lab-via-Templates-Part2/) Be a really quick catcher upper The Story so far and next So you have an ARM template in your library. It deployed a vNet a NIC and a VM (with a managed disk)."><meta property="og:title" content="Building an Azure lab environment via ARM templates - Part3 Saving Money with Auto Shutdown"><meta property="og:description" content="Aim This post will show you how to take your existing template and add a special resource to it which is a &ldquo;Schedules&rdquo; resource which shuts down your VM at a specified time to save you money.
Pre-reqs You&rsquo;ll need:
Read/do Part 1 (https://www.chrisneale.org/Azure-Lab-via-Templates-Part1/) Read/do Part 2 (https://www.chrisneale.org/Azure-Lab-via-Templates-Part2/) Be a really quick catcher upper The Story so far and next So you have an ARM template in your library. It deployed a vNet a NIC and a VM (with a managed disk)."><meta property="og:type" content="article"><meta property="og:url" content="https://www.chrisneale.org/posts/2018-10-21-azure-lab-via-templates-part3/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-10-21T10:00:00+00:00"><meta property="article:modified_time" content="2018-10-21T10:00:00+00:00"></head><body><header class=app-header><a href=https://www.chrisneale.org/><img class=app-header-avatar src=/avatar.jpg alt="John Doe"></a>
<span class=app-header-title>Chris Neales Blog</span><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vehicula turpis sit amet elit pretium.</p></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Building an Azure lab environment via ARM templates - Part3 Saving Money with Auto Shutdown</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Oct 21, 2018</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>3 min read</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://www.chrisneale.org/tags/azure/>Azure</a>
<a class=tag href=https://www.chrisneale.org/tags/template/>Template</a>
<a class=tag href=https://www.chrisneale.org/tags/automation/>Automation</a></div></div></header><div class=post-content><h2 id=aim>Aim</h2><p>This post will show you how to take your existing template and add a special resource to it which is a &ldquo;Schedules&rdquo; resource which shuts down your VM at a specified time to save you money.</p><h2 id=pre-reqs>Pre-reqs</h2><p>You&rsquo;ll need:</p><ul><li>Read/do Part 1 (<a href=https://www.chrisneale.org/Azure-Lab-via-Templates-Part1/>https://www.chrisneale.org/Azure-Lab-via-Templates-Part1/</a>)</li><li>Read/do Part 2 (<a href=https://www.chrisneale.org/Azure-Lab-via-Templates-Part2/>https://www.chrisneale.org/Azure-Lab-via-Templates-Part2/</a>)</li><li>Be a really quick catcher upper</li></ul><h2 id=the-story-so-far-and-next>The Story so far and next</h2><p>So you have an ARM template in your library. It deployed a vNet a NIC and a VM (with a managed disk).<br>Great&mldr;but please tell me you turned it off afterwards! You didn&rsquo;t? OK well hopefully you are following this series&mldr;.</p><p>Next we&rsquo;re going to add another resource which creates a Schedule to turn off your VM.</p><p>The code is based on the schema here
<a href=https://docs.microsoft.com/en-us/azure/templates/microsoft.devtestlab/schedules>https://docs.microsoft.com/en-us/azure/templates/microsoft.devtestlab/schedules</a>
In fact all of the ARM resource template schemas and properties can be found here so you can create your own templates as complex as you like.
I&rsquo;ve trimmed it down to only the properties we need.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;apiVersion&#34;</span>: <span style=color:#e6db74>&#34;[providers(&#39;Microsoft.DevTestLab&#39;,&#39;labs&#39;).apiVersions[0]]&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;dependsOn&#34;</span>: [
</span></span><span style=display:flex><span>           <span style=color:#e6db74>&#34;[concat(&#39;Microsoft.Network/virtualMachines/&#39;, &#39;DC01&#39;)]&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;Microsoft.DevTestLab/schedules&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Shutdown-DC01&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;location&#34;</span>: <span style=color:#e6db74>&#34;[resourceGroup().location]&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;Enabled&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;timeZoneId&#34;</span>: <span style=color:#e6db74>&#34;UTC&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;taskType&#34;</span>: <span style=color:#e6db74>&#34;ComputeVmShutdownTask&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;notificationSettings&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;Disabled&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;timeInMinutes&#34;</span>: <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;targetResourceId&#34;</span>: <span style=color:#e6db74>&#34;[resourceId(&#39;Microsoft.Compute/virtualMachines&#39;, &#39;DC01&#39;)]&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;dailyRecurrence&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;time&#34;</span>: <span style=color:#e6db74>&#34;1700&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It&rsquo;s very standard, the only things I&rsquo;ve set are the name of the schedule, the name of the VM (inside the targetresourceid property), the Time Zone and the Time to shutdown.
This is a resource so we just need to add this to the resource section of our template. Oh and we&rsquo;ve made sure it depends on the compute resource, so it only tries to create it once it&rsquo;s already there. Remember how?</p><ol><li>Go to your dashboard or All Services, if you don&rsquo;t have it pinned, and choose Templates</li><li>Click on your template and click edit</li><li>Click on &ldquo;ARM Template&rdquo; and paste in our new code above into the Resource section.</li></ol><p>Don&rsquo;t forget to put a comma before or after, depending on where you insert it.
So we should have a template that looks like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;$schema&#34;</span>: <span style=color:#e6db74>&#34;https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;contentVersion&#34;</span>: <span style=color:#e6db74>&#34;1.0.0.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;parameters&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;adminUsername&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;String&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;metadata&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Default Admin username&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;adminPassword&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;SecureString&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;metadata&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Default Admin password&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;variables&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;DC01VnetID&#34;</span>: <span style=color:#e6db74>&#34;[resourceId(&#39;Microsoft.Network/virtualNetworks&#39;, &#39;mylab-vnet&#39;)]&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;DC01SubnetRef&#34;</span>: <span style=color:#e6db74>&#34;[concat(variables(&#39;DC01VnetID&#39;), &#39;/subnets/&#39;, variables(&#39;mylab-vnetSubnet1Name&#39;))]&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;MyLab-vNetPrefix&#34;</span>: <span style=color:#e6db74>&#34;10.0.0.0/16&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;MyLab-vNetSubnet1Name&#34;</span>: <span style=color:#e6db74>&#34;Subnet-1&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;MyLab-vNetSubnet1Prefix&#34;</span>: <span style=color:#e6db74>&#34;10.0.0.0/24&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;MyLab-vNetSubnet2Name&#34;</span>: <span style=color:#e6db74>&#34;Subnet-2&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;MyLab-vNetSubnet2Prefix&#34;</span>: <span style=color:#e6db74>&#34;10.0.1.0/24&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;resources&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;Microsoft.DevTestLab/schedules&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;shutdown-computevm-DC01&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;apiVersion&#34;</span>: <span style=color:#e6db74>&#34;[providers(&#39;Microsoft.DevTestLab&#39;,&#39;labs&#39;).apiVersions[0]]&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;location&#34;</span>: <span style=color:#e6db74>&#34;[resourceGroup().location]&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;Enabled&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;timeZoneId&#34;</span>: <span style=color:#e6db74>&#34;UTC&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;taskType&#34;</span>: <span style=color:#e6db74>&#34;ComputeVmShutdownTask&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;notificationSettings&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;Disabled&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;timeInMinutes&#34;</span>: <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;targetResourceId&#34;</span>: <span style=color:#e6db74>&#34;[resourceId(&#39;Microsoft.Compute/virtualMachines&#39;, &#39;DC01&#39;)]&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;dailyRecurrence&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;time&#34;</span>: <span style=color:#e6db74>&#34;1700&#34;</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;dependsOn&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;[concat(&#39;Microsoft.Compute/virtualMachines/&#39;,&#39;DC01&#39;)]&#34;</span>
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;Microsoft.Compute/virtualMachines&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;DC01&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;apiVersion&#34;</span>: <span style=color:#e6db74>&#34;2017-03-30&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;location&#34;</span>: <span style=color:#e6db74>&#34;[resourceGroup().location]&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;osProfile&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;computerName&#34;</span>: <span style=color:#e6db74>&#34;DC01&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;adminUsername&#34;</span>: <span style=color:#e6db74>&#34;[parameters(&#39;adminUsername&#39;)]&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;adminPassword&#34;</span>: <span style=color:#e6db74>&#34;[parameters(&#39;adminPassword&#39;)]&#34;</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;hardwareProfile&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;vmSize&#34;</span>: <span style=color:#e6db74>&#34;Standard_B1ms&#34;</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;storageProfile&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;imageReference&#34;</span>: {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;publisher&#34;</span>: <span style=color:#e6db74>&#34;MicrosoftWindowsServer&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;offer&#34;</span>: <span style=color:#e6db74>&#34;WindowsServer&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;sku&#34;</span>: <span style=color:#e6db74>&#34;2016-Datacenter&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;latest&#34;</span>
</span></span><span style=display:flex><span>                    },
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;osDisk&#34;</span>: {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;createOption&#34;</span>: <span style=color:#e6db74>&#34;FromImage&#34;</span>
</span></span><span style=display:flex><span>                    },
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;dataDisks&#34;</span>: []
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;networkProfile&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;networkInterfaces&#34;</span>: [
</span></span><span style=display:flex><span>                        {
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;[resourceId(&#39;Microsoft.Network/networkInterfaces&#39;,&#39;DC01-NIC&#39;)]&#34;</span>
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    ]
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;dependsOn&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;[concat(&#39;Microsoft.Network/networkInterfaces/&#39;, &#39;DC01-NIC&#39;)]&#34;</span>
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;Microsoft.Network/networkInterfaces&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;DC01-NIC&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;apiVersion&#34;</span>: <span style=color:#e6db74>&#34;[providers(&#39;Microsoft.Network&#39;,&#39;networkInterfaces&#39;).apiVersions[0]]&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;location&#34;</span>: <span style=color:#e6db74>&#34;[resourceGroup().location]&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;tags&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;displayName&#34;</span>: <span style=color:#e6db74>&#34;DC01-NIC&#34;</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;ipConfigurations&#34;</span>: [
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;ipconfig1&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&#34;privateIPAllocationMethod&#34;</span>: <span style=color:#e6db74>&#34;Dynamic&#34;</span>,
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&#34;subnet&#34;</span>: {
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;[variables(&#39;DC01SubnetRef&#39;)]&#34;</span>
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;dependsOn&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;[concat(&#39;Microsoft.Network/virtualNetworks/&#39;, &#39;mylab-vnet&#39;)]&#34;</span>
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;Microsoft.Network/virtualNetworks&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;MyLab-vNet&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;apiVersion&#34;</span>: <span style=color:#e6db74>&#34;2015-06-15&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;location&#34;</span>: <span style=color:#e6db74>&#34;[resourceGroup().location]&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;tags&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;displayName&#34;</span>: <span style=color:#e6db74>&#34;MyLab-vNet&#34;</span>
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;addressSpace&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;addressPrefixes&#34;</span>: [
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#34;[variables(&#39;MyLab-vNetPrefix&#39;)]&#34;</span>
</span></span><span style=display:flex><span>                    ]
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;subnets&#34;</span>: [
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;[variables(&#39;MyLab-vNetSubnet1Name&#39;)]&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&#34;addressPrefix&#34;</span>: <span style=color:#e6db74>&#34;[variables(&#39;MyLab-vNetSubnet1Prefix&#39;)]&#34;</span>
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    },
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;[variables(&#39;MyLab-vNetSubnet2Name&#39;)]&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&#34;addressPrefix&#34;</span>: <span style=color:#e6db74>&#34;[variables(&#39;MyLab-vNetSubnet2Prefix&#39;)]&#34;</span>
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>            },
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;dependsOn&#34;</span>: []
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now save and deploy.
Once it&rsquo;s done you should see it&rsquo;s deployed 4 resources.
But&mldr;.the list in the resource group only shows three!
That&rsquo;s because the shutdown only shows up as a blade on the vm.<br></p><p>So there we have it, another quick addition, but an important money saving one.</p></div><div class=post-footer></div></article></main></body></html>