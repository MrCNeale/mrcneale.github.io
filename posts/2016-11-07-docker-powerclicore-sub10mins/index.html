<!doctype html><html lang=en-us><head><title>PowerCLI running in a Docker Container on Photon OS in under 10 minutes // Chris Neales Blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.105.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="John Doe"><meta name=description content><link rel=stylesheet href=/css/main.min.0fb49e70a30412f97ddfc418e18fefef1d9fcdebe45f634dbbba768b00fe1eec.css><meta name=twitter:card content="summary"><meta name=twitter:title content="PowerCLI running in a Docker Container on Photon OS in under 10 minutes"><meta name=twitter:description content="I needed a utility VM to run a PowerCLI script as a scheduled task.
I set out to do this using Windows but stopped as VMware&rsquo;s Geniuses had just released the PowerCLIcore Fling. This instantly made me think, smaller footprint, quicker to deploy, zero OS license cost&mldr;&mldr;No Brainer really
To recreate this all you need is something to host your Photon VM. Standalone ESXi host or VMWorkstation.
Oh and a VCSA/ESXi to connect to (v5."><meta property="og:title" content="PowerCLI running in a Docker Container on Photon OS in under 10 minutes"><meta property="og:description" content="I needed a utility VM to run a PowerCLI script as a scheduled task.
I set out to do this using Windows but stopped as VMware&rsquo;s Geniuses had just released the PowerCLIcore Fling. This instantly made me think, smaller footprint, quicker to deploy, zero OS license cost&mldr;&mldr;No Brainer really
To recreate this all you need is something to host your Photon VM. Standalone ESXi host or VMWorkstation.
Oh and a VCSA/ESXi to connect to (v5."><meta property="og:type" content="article"><meta property="og:url" content="https://www.chrisneale.org/posts/2016-11-07-docker-powerclicore-sub10mins/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-11-07T22:00:00+00:00"><meta property="article:modified_time" content="2016-11-07T22:00:00+00:00"></head><body><header class=app-header><a href=https://www.chrisneale.org/><img class=app-header-avatar src=/avatar.jpg alt="John Doe"></a>
<span class=app-header-title>Chris Neales Blog</span><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vehicula turpis sit amet elit pretium.</p></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>PowerCLI running in a Docker Container on Photon OS in under 10 minutes</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Nov 7, 2016</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>1 min read</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://www.chrisneale.org/tags/docker/>Docker</a>
<a class=tag href=https://www.chrisneale.org/tags/powercli/>PowerCLI</a>
<a class=tag href=https://www.chrisneale.org/tags/powershell/>PowerShell</a>
<a class=tag href=https://www.chrisneale.org/tags/containers/>Containers</a>
<a class=tag href=https://www.chrisneale.org/tags/vmware/>VMware</a></div></div></header><div class=post-content><p>I needed a utility VM to run a PowerCLI script as a scheduled task.<br>I set out to do this using Windows but stopped as VMware&rsquo;s Geniuses had just released the PowerCLIcore Fling. This instantly made me think, smaller footprint, quicker to deploy, zero OS license cost&mldr;&mldr;<strong>No Brainer really</strong><br>To recreate this all you need is something to host your Photon VM. Standalone ESXi host or VMWorkstation.<br>Oh and a VCSA/ESXi to connect to (v5.5 or higher)&mldr;but then you wouldn&rsquo;t be here if you didn&rsquo;t have that already!<br>Erm&mldr;I also decided to demonstrate it with a video, because, erm, why not?</p><iframe width=560 height=315 src=https://www.youtube.com/embed/hhsu00m05zU frameborder=0 allowfullscreen></iframe><hr>Glossary of commands/useful information<p>PowerShell Command to download OVA<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span><span style=color:#66d9ef>Invoke</span><span style=color:#f92672>-</span><span style=color:#66d9ef>WebRequest</span> <span style=color:#f92672>-</span><span style=color:#66d9ef>Uri</span> <span style=color:#e6db74>https</span>:<span style=color:#e6db74>//</span>bintray<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>vmware<span style=color:#f92672>/</span>photon<span style=color:#f92672>/</span>download_file?file_path<span style=color:#f92672>=</span>photon<span style=color:#f92672>-</span>custom<span style=color:#f92672>-</span>hw10<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>13</span>c08b6<span style=color:#f92672>.</span>ova <span style=color:#f92672>-</span><span style=color:#66d9ef>OutFile</span> <span style=color:#e6db74>c</span>:\users\chris\downloads\photon<span style=color:#f92672>.</span>ova</span></span></code></pre></div>Photon OVA default root password=changeme</p><p>Photon/Linux systemctl setup Commands<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>systemctl enable docker
</span></span><span style=display:flex><span>systemctl start docker</span></span></code></pre></div>Docker Commands<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>docker run <span style=color:#f92672>-</span>it vmware<span style=color:#f92672>/</span>powerclicore
</span></span><span style=display:flex><span>docker ps
</span></span><span style=display:flex><span>docker images
</span></span><span style=display:flex><span>docker rmi <span style=color:#f92672>-</span>f vmware<span style=color:#f92672>/</span>powerclicore</span></span></code></pre></div>PowerCLI Commands<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=display:flex><span>set<span style=color:#f92672>-</span>powercliconfiguration <span style=color:#f92672>-</span>invalidcertificateaction ignore <span style=color:#f92672>-</span><span style=color:#e6db74>confirm</span>:$false
</span></span><span style=display:flex><span>connect<span style=color:#f92672>-</span>viserver <span style=color:#f92672>-</span>server <span style=color:#ae81ff>192</span><span style=color:#f92672>.</span><span style=color:#ae81ff>168</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>.</span><span style=color:#ae81ff>200</span> <span style=color:#f92672>-</span>user administrator@vsphere<span style=color:#f92672>.</span>local <span style=color:#f92672>-</span>password vmware
</span></span><span style=display:flex><span>get<span style=color:#f92672>-</span>cluster
</span></span><span style=display:flex><span>get<span style=color:#f92672>-</span>vmhost
</span></span><span style=display:flex><span>get<span style=color:#f92672>-</span>vm
</span></span><span style=display:flex><span>exit</span></span></code></pre></div></p></div><div class=post-footer></div></article></main></body></html>